## ADDED Requirements
### Requirement: Edgar filing automation retrieval_agent
The system SHALL expose a `retrieval_agent` that orchestrates the Edgar tooling workflow, invoking the filing search tool, then automatically upserting results into the vector database, calling the RAG retrieve tool to answer the user query, and augmenting the response with relevant market news and sentiment via `src/agent_tools/alpha_vantage_mcp.py`. Implementation expectations align with `src/agents/analyst/retrieval_agent.py`, even if the current functions and comments are incomplete.

#### Scenario: Orchestrate the full workflow for a user question
- **WHEN** a user asks for insight derived from Edgar filings (e.g., "What did Company X disclose about its recent acquisition?")
- **THEN** the agent calls the search tool, falls back to no-op upsert when no new documents arrive, invokes the retrieve tool with the upserted content, supplements the answer with relevant news/sentiment via `alpha_vantage_mcp`, and returns a final structured JSON response that includes the generated answer plus references to the filings used.

### Requirement: News and sentiment context enrichment
The `retrieval_agent` SHALL query `src/agent_tools/alpha_vantage_mcp.py` for news and sentiment relevant to the user query and include this context (e.g., headlines, sentiment scores) inside the response `metadata` or `filings` entries.

#### Scenario: Provide news sentiment alongside filings
- **WHEN** the Edgar workflow runs for a company or topic with recent news
- **THEN** the agent returns a JSON payload whose `metadata` includes a `news` array summarizing headlines and sentiment tags so clients can correlate filings with live market sentiment.

### Requirement: Structured JSON response for Edgar insights
The Edgar agent SHALL only surface output via a deterministic JSON payload containing at least `query`, `status`, `filings`, `answer`, and `metadata` keys, where `filings` is a list of sources (with `cik`, `filing_type`, `date`, `snippet`) and `metadata` includes tool usage stats such as start/end time and any warnings.

#### Scenario: Return JSON payload on success
- **WHEN** the workflow completes without blocked tools
- **THEN** the agent responds with a JSON object that explicitly shows the original query, the answer text generated by RAG, a list of filing references, and metadata describing the search/upsert/retrieve steps, allowing downstream callers to parse the result programmatically.

### Requirement: Surface actionable failure information
The Edgar agent SHALL describe any failures (e.g., search tool timeout, no filings found, retrieve tool error) within the `status` and `metadata.warnings` fields of the JSON payload instead of exposing raw tool errors to the user.

#### Scenario: No filings found
- **WHEN** the search tool returns zero filings for the user query
- **THEN** the agent returns a JSON response with `status` set to `partial` or `failed`, an empty `filings` array, and `metadata.warnings` explaining that no Edgar filings matched the query while still preserving the request shape for clients to inspect.
